---
tags:
- sentence-transformers
- sentence-similarity
- feature-extraction
- generated_from_trainer
- dataset_size:104643
- loss:MultipleNegativesRankingLoss
base_model: sentence-transformers/msmarco-distilbert-base-dot-prod-v3
widget:
- source_sentence: who saved the jewelled eye of a sacred idol
  sentences:
  - Commandant Eric Lassard (George Gaynes) decides that the police force is overworked
    and understaffed, so he comes up with the idea of recruiting civilian volunteers
    to work side-by-side with his officers in a program called "Citizens On Patrol"
    (COP). Carey Mahoney (Steve Guttenberg) and his friends Moses Hightower (Bubba
    Smith), Larvell Jones (Michael Winslow), Eugene Tackleberry (David Graf), Zed
    (Bobcat Goldthwait), Sweetchuck (Tim Kazurinsky), Laverne Hooks (Marion Ramsey),
    and Debbie Callahan (Leslie Easterbrook) are in charge of training the civilians.
    The civilians include the enormous Tommy "House" Conklin (Tab Thacker), gung-ho
    senior citizen Lois Feldman (Billie Bird), Tackleberry's own father-in-law, and
    skateboarding delinquents Kyle (David Spade) and Arnie (Brian Backer). They were
    caught by Capt. Harris, and the judge is about to throw the book at them until
    Mahoney speaks to the judge to let Arnie and Kyle join the COP program as alternative
    punishment. The judge agrees to this, and the boys are joined by their unsuccessful
    attorney, Butterworth (Derek McGrath).
  - In India, a British soldier saves the jewelled eye of a sacred idol.
  - In the mid-21st century, crop blights and dust storms threaten humanity's survival.
    Joseph Cooper, a widowed engineer and former NASA pilot, runs a farm with his
    father-in-law Donald, son Tom, and daughter Murphy. Living in a post-truth society,
    Cooper is reprimanded for telling Murphy that the Apollo missions were not fake;
    he encourages her to carefully observe and record what she sees. They discover
    that dust patterns, which Murphy first attributes to a ghost, result from gravity
    variations, and translate into geographic coordinates. These lead them to a secret
    NASA facility headed by Cooper's former supervisor, Professor John Brand, who
    explains that 48 years earlier a wormhole appeared near Saturn, opening a path
    to a distant galaxy with twelve potentially habitable planets located near a black
    hole named Gargantua. Volunteers had previously traveled through the wormhole
    to evaluate the planets, with Miller, Edmunds, and Mann reporting back desirable
    results. Brand explains he has conceived two plans to ensure humanitys survival
    - Plan A involves developing a gravitational propulsion theory, allowing a mass
    exodus from Earth, while Plan B is a conventional launch of the Endurance spacecraft
    with 5,000 frozen embryos to colonize a habitable planet. Cooper is recruited
    to pilot the Endurance. When Murphy refuses to see him off, he leaves her his
    wristwatch to compare their relative time when he returns.
- source_sentence: who plays the crew in b for bertie
  sentences:
  - '"B for Bertie" is an RAF Vickers Wellington bomber whose crew is forced to bail
    out over the Netherlands near the Zuider Zee after one of their engines is damaged
    during a nighttime raid on Stuttgart. Five of the six airmen find each other;
    the sixth goes missing. The first Dutch citizens they encounter, led by English-speaking
    school teacher Else Meertens (Pamela Brown), are suspicious at first as no aircraft
    is reported to have crashed in the Netherlands (the abandoned bomber actually
    reaches England before hitting a pylon). After much debate and some questioning,
    the Dutch agree to help, despite their fear of German reprisals.'
  - In 1931, a Missourian meat heiress is robbed by three men, who panic after murdering
    her boyfriend and kidnap her. At their hideout, the three are ambushed and killed
    by Eddie Hagan, who happened to witness the crime, and the rest of the notorious
    Grissom Gang.
  - Kiira seems like an ordinary young girl, who likes to dress up. What differentiates
    her from others is that she is a vampire. She has never told anyone her secret
    including her first love, Tetsu. After her parents died when Kiira was 12 years
    old, she needed to live with her relatives and lost contact with Tetsu. But 8
    years later, Tetsu appears at the bakery where Kiira works...[3]
- source_sentence: who is max webster
  sentences:
  - Flavors tells the stories of 13 different main characters in 5 parallel story
    lines. The marriage of NRI Rad (Anupam Mittal) to his American fiance (Jicky Schnee)
    brings his family to the US where they quickly adapt to American ways. Meanwhile,
    Kartik (Reef Karim), tries to maintain a long distance relationship with his friend
    Rachna (Pooja Kumar) and bored housewife Sangita (Sireesha Katragadda) is neglected
    by her workaholic husband (Gaurang Vyas).
  - Maxwell Webster is a Montana attorney whose career isn't going as well as wife
    Julie feels it should be. She gets tipsy at a country club and praises her husband's
    work in front of colleagues, then urges him to ask boss Edmund Jethrow for a partnership.
    Instead, he loses his job.
  - Art dealer Henri Landru becomes infatuated with burlesque performer, Odette, who
    already has a lover and is only interested in Landru for money. She tricks Landru
    into thinking her mother is sick and needs money for an important operation. Landru
    vows to raise the money to fund the operation.
- source_sentence: who plays ashok in shatabana
  sentences:
  - Ashok Mehra (Rajesh Khanna), is a wealthy industrialist, whose business produces
    cosmetic products. He is happily married to Purnima (Rekha), but she suffers complications
    after giving birth to their daughter, and the doctors are not able to save her
    life, leaving Ashok devastated. He is able to pull himself together and rediscover
    his will to live only because of his obligation to his daughter, Mini.
  - On April 18, 1987, at a bar, working-class woman Sarah Tobias is gang raped by
    several drunk bar patrons, while onlookers cheer them on. Assistant district attorney
    Kathryn Murphy is assigned to the rape case. Her superior instructs Murphy to
    offer a plea bargain with the rape defendants that requires some jail time. They
    make a plea bargain to charges of reckless endangerment, and are sentenced to
    prison. Sarah is enraged by the deal, as there is no acknowledgment on the record
    that the men raped her.
  - Set in turn-of-the-century New York, wealthy playboy Charles Hill (Fred Astaire)
    is causing difficulties for his guardian, Aunt Lettie (Marjorie Main) and lawyer,
    Max (Keenan Wynn). Prone to fall in love then ditching his showgirl brides-to-be
    at the altar, the compensation bills are mounting. After the most recent episode,
    he hears Angela (Vera-Ellen) leading a Salvation Army band in song. He falls in
    love at first sight and when she scoffs at him, telling him that if he were in
    love his feet would leave the ground, he promptly floats high into the air. He
    pursues her, even vowing to do an honest day's work for the first time in his
    life. After various attempts to convince her, Angela's feeling finally cause her
    feet to leave the ground. After a couple of misunderstandings are resolved, they
    float into the air together, to a chorus of well-wishers below.
- source_sentence: who was kripal in veeran
  sentences:
  - Raghunandan (Kunchacko Boban) is a native of Chenankuzhi village and the son of
    Gangadharan (Innocent), the village postman. Gangadharan is a lazy man and does
    not do his duties well. Raghu has to face the anger of the villagers because his
    father does not deliver the mails or money orders in time.
  - The story is set in mid-to-late 1980s in the Indian state of Punjab which had
    been wrecked by a violent insurgency in the aftermath of Operation Blue Star,
    the assassination of Prime Minister Indira Gandhi, and the subsequent 1984 Anti-Sikh
    riots. The story is relayed by a series of flashbacks.
  - Samir Horn (Don Cheadle) is an Arabic-speaking Sudanese-American and devout Muslim.
    His Sudanese father was killed by a car bomb when he was a child. As an adult,
    Samir is first seen operating as an arms dealer. While negotiating a deal with
    Omar (Sad Taghmaoui) in Yemen he is arrested and thrown into a Yemeni jail. Later,
    Samir and Omar become friends and when Omar's people arrange an escape, he takes
    Samir with them. They meet Fareed (Alyy Khan), a lieutenant in the al-Nathir terrorist
    organization. FBI Special Agent Roy Clayton (Guy Pearce) suspects Samir has been
    radicalized and begins tracking him.
pipeline_tag: sentence-similarity
library_name: sentence-transformers
---

# SentenceTransformer based on sentence-transformers/msmarco-distilbert-base-dot-prod-v3

This is a [sentence-transformers](https://www.SBERT.net) model finetuned from [sentence-transformers/msmarco-distilbert-base-dot-prod-v3](https://huggingface.co/sentence-transformers/msmarco-distilbert-base-dot-prod-v3). It maps sentences & paragraphs to a 768-dimensional dense vector space and can be used for semantic textual similarity, semantic search, paraphrase mining, text classification, clustering, and more.

## Model Details

### Model Description
- **Model Type:** Sentence Transformer
- **Base model:** [sentence-transformers/msmarco-distilbert-base-dot-prod-v3](https://huggingface.co/sentence-transformers/msmarco-distilbert-base-dot-prod-v3) <!-- at revision 76ce77c5ed084214fd7319d3c92d75500c7c5220 -->
- **Maximum Sequence Length:** 512 tokens
- **Output Dimensionality:** 768 dimensions
- **Similarity Function:** Dot Product
<!-- - **Training Dataset:** Unknown -->
<!-- - **Language:** Unknown -->
<!-- - **License:** Unknown -->

### Model Sources

- **Documentation:** [Sentence Transformers Documentation](https://sbert.net)
- **Repository:** [Sentence Transformers on GitHub](https://github.com/UKPLab/sentence-transformers)
- **Hugging Face:** [Sentence Transformers on Hugging Face](https://huggingface.co/models?library=sentence-transformers)

### Full Model Architecture

```
SentenceTransformer(
  (0): Transformer({'max_seq_length': 512, 'do_lower_case': False}) with Transformer model: DistilBertModel 
  (1): Pooling({'word_embedding_dimension': 768, 'pooling_mode_cls_token': False, 'pooling_mode_mean_tokens': True, 'pooling_mode_max_tokens': False, 'pooling_mode_mean_sqrt_len_tokens': False, 'pooling_mode_weightedmean_tokens': False, 'pooling_mode_lasttoken': False, 'include_prompt': True})
  (2): Dense({'in_features': 768, 'out_features': 768, 'bias': False, 'activation_function': 'torch.nn.modules.linear.Identity'})
)
```

## Usage

### Direct Usage (Sentence Transformers)

First install the Sentence Transformers library:

```bash
pip install -U sentence-transformers
```

Then you can load this model and run inference.
```python
from sentence_transformers import SentenceTransformer

# Download from the 🤗 Hub
model = SentenceTransformer("sentence_transformers_model_id")
# Run inference
sentences = [
    'who was kripal in veeran',
    'The story is set in mid-to-late 1980s in the Indian state of Punjab which had been wrecked by a violent insurgency in the aftermath of Operation Blue Star, the assassination of Prime Minister Indira Gandhi, and the subsequent 1984 Anti-Sikh riots. The story is relayed by a series of flashbacks.',
    "Samir Horn (Don Cheadle) is an Arabic-speaking Sudanese-American and devout Muslim. His Sudanese father was killed by a car bomb when he was a child. As an adult, Samir is first seen operating as an arms dealer. While negotiating a deal with Omar (Sad Taghmaoui) in Yemen he is arrested and thrown into a Yemeni jail. Later, Samir and Omar become friends and when Omar's people arrange an escape, he takes Samir with them. They meet Fareed (Alyy Khan), a lieutenant in the al-Nathir terrorist organization. FBI Special Agent Roy Clayton (Guy Pearce) suspects Samir has been radicalized and begins tracking him.",
]
embeddings = model.encode(sentences)
print(embeddings.shape)
# [3, 768]

# Get the similarity scores for the embeddings
similarities = model.similarity(embeddings, embeddings)
print(similarities.shape)
# [3, 3]
```

<!--
### Direct Usage (Transformers)

<details><summary>Click to see the direct usage in Transformers</summary>

</details>
-->

<!--
### Downstream Usage (Sentence Transformers)

You can finetune this model on your own dataset.

<details><summary>Click to expand</summary>

</details>
-->

<!--
### Out-of-Scope Use

*List how the model may foreseeably be misused and address what users ought not to do with the model.*
-->

<!--
## Bias, Risks and Limitations

*What are the known or foreseeable issues stemming from this model? You could also flag here known failure cases or weaknesses of the model.*
-->

<!--
### Recommendations

*What are recommendations with respect to the foreseeable issues? For example, filtering explicit content.*
-->

## Training Details

### Training Dataset

#### Unnamed Dataset

* Size: 104,643 training samples
* Columns: <code>sentence_0</code> and <code>sentence_1</code>
* Approximate statistics based on the first 1000 samples:
  |         | sentence_0                                                                       | sentence_1                                                                           |
  |:--------|:---------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------|
  | type    | string                                                                           | string                                                                               |
  | details | <ul><li>min: 5 tokens</li><li>mean: 9.62 tokens</li><li>max: 31 tokens</li></ul> | <ul><li>min: 11 tokens</li><li>mean: 131.79 tokens</li><li>max: 512 tokens</li></ul> |
* Samples:
  | sentence_0                                             | sentence_1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
  |:-------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
  | <code>who is the village chief in the chinese</code>   | <code>Village Chief Shangang is not a bad man, but he often metes out justice as he sees it without regard to the law. To punish a woman accused of beating and otherwise abusing her old mother-in-law, Shangang has her bound and exhibited in the village in humiliating fashion, after which the woman hangs herself in front of his door. Her husband threatens to report Shangang to higher authorities, and eventually prosecutors Su Qiang and Xiao Ding come to investigate after being tipped off by an anonymous letter. They find that they have to take Shangang away for his illegal treatment of the woman, and when the villagers complain, Shangang himself tells them to uncomplainingly accept the law.</code> |
  | <code>who plays the dogs on the palm beach post</code> | <code>Soon after their wedding, John and Jenny Grogan (Owen Wilson and Jennifer Aniston) escape the brutal Michigan winters and relocate to a cottage in South Florida, where they are hired as reporters for competing newspapers. At The Palm Beach Post, Jenny immediately receives prominent front-page assignments, while at the South Florida Sun-Sentinel, John finds himself writing obituaries and two-paragraph articles about mundane news like a fire at the local garbage dump.</code>                                                                                                                                                                                                                               |
  | <code>what is ashok's family</code>                    | <code>Ashok comes from a wealthy family, which is run by his dad, and elder brother, Alok. Ashok himself is a slacker, and is only interested in slacking, and playing practical jokes, and no doubt his favorite day is fool's day, 1 April, when he outdoes himself. His jokes befriend him with Madhu, and both fall in love. Then a practical joke hits the truth, and both Ashok and Madhu become targets of an international gang, and must run for their own safety, as well as for the safety of their respective families.</code>                                                                                                                                                                                        |
* Loss: [<code>MultipleNegativesRankingLoss</code>](https://sbert.net/docs/package_reference/sentence_transformer/losses.html#multiplenegativesrankingloss) with these parameters:
  ```json
  {
      "scale": 20.0,
      "similarity_fct": "cos_sim"
  }
  ```

### Training Hyperparameters
#### Non-Default Hyperparameters

- `num_train_epochs`: 1
- `multi_dataset_batch_sampler`: round_robin

#### All Hyperparameters
<details><summary>Click to expand</summary>

- `overwrite_output_dir`: False
- `do_predict`: False
- `eval_strategy`: no
- `prediction_loss_only`: True
- `per_device_train_batch_size`: 8
- `per_device_eval_batch_size`: 8
- `per_gpu_train_batch_size`: None
- `per_gpu_eval_batch_size`: None
- `gradient_accumulation_steps`: 1
- `eval_accumulation_steps`: None
- `torch_empty_cache_steps`: None
- `learning_rate`: 5e-05
- `weight_decay`: 0.0
- `adam_beta1`: 0.9
- `adam_beta2`: 0.999
- `adam_epsilon`: 1e-08
- `max_grad_norm`: 1
- `num_train_epochs`: 1
- `max_steps`: -1
- `lr_scheduler_type`: linear
- `lr_scheduler_kwargs`: {}
- `warmup_ratio`: 0.0
- `warmup_steps`: 0
- `log_level`: passive
- `log_level_replica`: warning
- `log_on_each_node`: True
- `logging_nan_inf_filter`: True
- `save_safetensors`: True
- `save_on_each_node`: False
- `save_only_model`: False
- `restore_callback_states_from_checkpoint`: False
- `no_cuda`: False
- `use_cpu`: False
- `use_mps_device`: False
- `seed`: 42
- `data_seed`: None
- `jit_mode_eval`: False
- `use_ipex`: False
- `bf16`: False
- `fp16`: False
- `fp16_opt_level`: O1
- `half_precision_backend`: auto
- `bf16_full_eval`: False
- `fp16_full_eval`: False
- `tf32`: None
- `local_rank`: 0
- `ddp_backend`: None
- `tpu_num_cores`: None
- `tpu_metrics_debug`: False
- `debug`: []
- `dataloader_drop_last`: False
- `dataloader_num_workers`: 0
- `dataloader_prefetch_factor`: None
- `past_index`: -1
- `disable_tqdm`: False
- `remove_unused_columns`: True
- `label_names`: None
- `load_best_model_at_end`: False
- `ignore_data_skip`: False
- `fsdp`: []
- `fsdp_min_num_params`: 0
- `fsdp_config`: {'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False}
- `fsdp_transformer_layer_cls_to_wrap`: None
- `accelerator_config`: {'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'non_blocking': False, 'gradient_accumulation_kwargs': None}
- `deepspeed`: None
- `label_smoothing_factor`: 0.0
- `optim`: adamw_torch
- `optim_args`: None
- `adafactor`: False
- `group_by_length`: False
- `length_column_name`: length
- `ddp_find_unused_parameters`: None
- `ddp_bucket_cap_mb`: None
- `ddp_broadcast_buffers`: False
- `dataloader_pin_memory`: True
- `dataloader_persistent_workers`: False
- `skip_memory_metrics`: True
- `use_legacy_prediction_loop`: False
- `push_to_hub`: False
- `resume_from_checkpoint`: None
- `hub_model_id`: None
- `hub_strategy`: every_save
- `hub_private_repo`: None
- `hub_always_push`: False
- `hub_revision`: None
- `gradient_checkpointing`: False
- `gradient_checkpointing_kwargs`: None
- `include_inputs_for_metrics`: False
- `include_for_metrics`: []
- `eval_do_concat_batches`: True
- `fp16_backend`: auto
- `push_to_hub_model_id`: None
- `push_to_hub_organization`: None
- `mp_parameters`: 
- `auto_find_batch_size`: False
- `full_determinism`: False
- `torchdynamo`: None
- `ray_scope`: last
- `ddp_timeout`: 1800
- `torch_compile`: False
- `torch_compile_backend`: None
- `torch_compile_mode`: None
- `include_tokens_per_second`: False
- `include_num_input_tokens_seen`: False
- `neftune_noise_alpha`: None
- `optim_target_modules`: None
- `batch_eval_metrics`: False
- `eval_on_start`: False
- `use_liger_kernel`: False
- `liger_kernel_config`: None
- `eval_use_gather_object`: False
- `average_tokens_across_devices`: False
- `prompts`: None
- `batch_sampler`: batch_sampler
- `multi_dataset_batch_sampler`: round_robin

</details>

### Training Logs
| Epoch  | Step  | Training Loss |
|:------:|:-----:|:-------------:|
| 0.0382 | 500   | 0.3629        |
| 0.0764 | 1000  | 0.3439        |
| 0.1147 | 1500  | 0.3372        |
| 0.1529 | 2000  | 0.3119        |
| 0.1911 | 2500  | 0.3168        |
| 0.2293 | 3000  | 0.2989        |
| 0.2676 | 3500  | 0.251         |
| 0.3058 | 4000  | 0.2599        |
| 0.3440 | 4500  | 0.29          |
| 0.3822 | 5000  | 0.263         |
| 0.4205 | 5500  | 0.2618        |
| 0.4587 | 6000  | 0.2628        |
| 0.4969 | 6500  | 0.2626        |
| 0.5351 | 7000  | 0.2565        |
| 0.5734 | 7500  | 0.245         |
| 0.6116 | 8000  | 0.2393        |
| 0.6498 | 8500  | 0.2353        |
| 0.6880 | 9000  | 0.2393        |
| 0.7262 | 9500  | 0.2428        |
| 0.7645 | 10000 | 0.2195        |
| 0.8027 | 10500 | 0.2362        |
| 0.8409 | 11000 | 0.2228        |
| 0.8791 | 11500 | 0.2198        |
| 0.9174 | 12000 | 0.2143        |
| 0.9556 | 12500 | 0.217         |
| 0.9938 | 13000 | 0.2302        |


### Framework Versions
- Python: 3.11.13
- Sentence Transformers: 4.1.0
- Transformers: 4.53.3
- PyTorch: 2.6.0+cu124
- Accelerate: 1.9.0
- Datasets: 4.0.0
- Tokenizers: 0.21.2

## Citation

### BibTeX

#### Sentence Transformers
```bibtex
@inproceedings{reimers-2019-sentence-bert,
    title = "Sentence-BERT: Sentence Embeddings using Siamese BERT-Networks",
    author = "Reimers, Nils and Gurevych, Iryna",
    booktitle = "Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing",
    month = "11",
    year = "2019",
    publisher = "Association for Computational Linguistics",
    url = "https://arxiv.org/abs/1908.10084",
}
```

#### MultipleNegativesRankingLoss
```bibtex
@misc{henderson2017efficient,
    title={Efficient Natural Language Response Suggestion for Smart Reply},
    author={Matthew Henderson and Rami Al-Rfou and Brian Strope and Yun-hsuan Sung and Laszlo Lukacs and Ruiqi Guo and Sanjiv Kumar and Balint Miklos and Ray Kurzweil},
    year={2017},
    eprint={1705.00652},
    archivePrefix={arXiv},
    primaryClass={cs.CL}
}
```

<!--
## Glossary

*Clearly define terms in order to be accessible across audiences.*
-->

<!--
## Model Card Authors

*Lists the people who create the model card, providing recognition and accountability for the detailed work that goes into its construction.*
-->

<!--
## Model Card Contact

*Provides a way for people who have updates to the Model Card, suggestions, or questions, to contact the Model Card authors.*
-->